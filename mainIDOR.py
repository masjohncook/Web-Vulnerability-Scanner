from general import *
import re


class mainIdor:

    def __init__(self, url, prname):
        self.url = url
        self.prname = prname
        self.urlParm = list()

        self.listUrl = file_to_set(prname + "/crawled.txt")
        self.boot()

    def boot(self):
        for url in self.listUrl:
            cek = cek_link_with_parm(url)
            if cek is True:
                self.urlParm.append(url)
        print(self.urlParm)

    def traversal_attack(self, link):
        list_attack = set_to_file("list_PaTrav_attack.txt")
        split = re.split("([^\?]+)(\?.*=)", link)
        for a in list_attack:
            print(split[1] + a)
        for a in list_attack:
            print(split[1] + split[2] + a)

#traversal_attack("http://testsite.com/get.php?f=list$g=coba")
mainIdor('https://www.hackthissite.org', 'hack')