import subprocess
import os
from general import *

class mainSecMisconf:

    def __init__(self, url):
        self.url = url
        #self.prName  = prName
        #self.nmap("-F", self.url)
        #self.nmap("-sV -sC", self.url)
        self.nmap("-v --script vuln", self.url)


    def nmap(self, option, url):
        command = ("nmap " + option + " " + url)
        result = subprocess.Popen(command, stdout=subprocess.PIPE, shell=True)
        out, err = result.communicate()
        code = result.returncode
        # print(code)
        if code is 0:
            process = os.popen(command)
            output = str(process.read())
            append_to_file("file.txt", output)
            return print(output)
        elif code is 127:
            print("system dont have nmap")
            return False
        else:
            return False

#mainSecMisconf("www.ilmuhacking.com")
#delete_file_contents("file.txt")
#mainSecMisconf("192.168.10.13")

